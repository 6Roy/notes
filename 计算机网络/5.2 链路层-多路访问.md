# 多路访问控制
> 参考文献
> * [计算机网络——“自顶向下方法之链路层](https://blog.csdn.net/diaotai/article/details/79329853)
> * [计算机网络-链路层](https://blog.csdn.net/Hemk340200600/article/details/61424709)



## 1 概述

### 点对点链路

由链路一端的单个发送方和链路另一端的单个接收方组成。使用的协议包括：点对点协议（PPP）、高级数据链路控制（HDLC）。

### 广播链路

多个发送和接受节点都连接到相同的、单一的、共享的广播信道上。多路访问协议用于规范节点在共享的广播信道上的传输行为。

多路访问控制（multiple access control protocol,MAC）协议可以分为三类——信道划分协议，随机接入协议和轮流协议。

* TDM和FDM都是信道划分协议，而CDMA则是码分多址，如果配置恰当，可以同时接收节点而不被干扰。

* 随机接入协议在每一次碰撞后等待随机时间再发。时隙ALOHA是一个很简单的随机接入协议，而AHOHA效率是时隙ALOHA的一半。载波侦听多路访问（CSMA）会在开始之前监测是否有人说话，而如果其他人同时开始说话，则停下。

* 轮流协议轮效率低下，若调配节点出问题则崩盘。轮流协议包括令牌协议。



## 2 MAC-信道划分协议
### TDM
时分多路复用（TDM），将时间划分为时间帧，并进一步划分每个时间帧为N个时隙，每个时隙分配给N个结点中的一个，结点有分组要发送时，在循环的TDM帧中指派给它的时隙内传输分组比特。时隙长度应该使得一个时隙内能够传输单个分组。它消除了碰撞并且十分公平，然而结点被限制为R/N的最高速率，即使他是唯一有分组要发送的结点时。

### FDM
频分多路复用（FDM），将R bps信道划分为不同的频段，并把每个频率分配给N个结点中的一个。FDM的优缺点跟TDM一样。

### CDMA
码分多址（CDMA），CDMA每个结点分配一种不同的编码。每个结点用它唯一的编码发对它发送的数据进行编码，如果精心选择这些编码，则不同的结点能够同时传输，并且相应的接收方仍能正确接收发送方编码的数据比特（接收方必须知道发送方的编码），而不在乎其他结点的干扰。

## 3 MAC-随机接入协议

### 时隙ALOHA

该协议操作如下：

1. 当有一个新帧要发送时，等到下一个时隙开始并在该时隙传输整个帧。

2. 如果没有碰撞则结点成功传输它的帧，不需要考虑重传。如果该结点还有新帧要传输，则进行准备。

3. 如有有碰撞，在时隙结束之前检测到这次碰撞。以概率p在后续的每个时隙中重传它的帧，知道该帧被无碰撞地传输出去。

该协议允许该结点以全速传输，并且每个结点需要对时隙同步。该协议的一个结论是，当有大量结点有很多帧要传输时，最多仅有37%的时隙做有用工作，37%的时隙是空闲的，26%的时隙有碰撞。

### ALOHA
第一个ALOHA实际上是一个非时隙，完全分散的协议。当一个帧首次到达时，结点立刻将该帧完整地传输进广播信道，如果经历碰撞，则立刻以概率p重传该帧，否则等待一个帧传输时间。其最大效率为时隙ALOHA的一半。

### CSMA

载波侦听：一个结点在传输前先听信道，如果来自另外一个结点的帧正在传送，则等待直到检测一小段时间内没有传输再开始传输。

### CSMA/CD

碰撞检测：一个传输结点在传输时一直在侦听信道，如果检测到另一个结点正在传输干扰帧，就停止传输，并等待一段随机时间后再次进入“侦听-当空闲时传输”循环。具有碰撞检测的CSMA被称为CSMA/CD（CSMAwith cCollision Detection）.

所有结点都监听信道，为什么还会发生碰撞呢？这是因为，比特沿着广播媒体传播锁实际需要的时间不是零（虽然以光的速度），端到端之间存在信道传播时延。

在CSMA/CD中，如果在传输过程中检测到其他结点也再传输，则停止自身传输并等待一段时间，这个时间的确定我们使用用于以太网以及DOCSIS电缆网络多路访问协议中的二进制指数后退算法来解决。当一个给定的帧经历第n次碰撞时，它从0到2^n-1中等概率地选择一个数。随着碰撞次数的增大，选择的集合长度呈指数式增长。这是合理的，因为一个帧碰撞的次数越多，说明它应该降低自己传输的频率来让给其他帧更多时间传输完它的数据。


## 4 MAC-轮流协议

### 轮询协议

对于N个结点，轮询协议要求这些结点之一要被指定为主节点。主节点以循环的方式轮询每个结点。主节点向结点1发送报文告诉它能够传输的帧的最大数量，结点1传输了某些帧后，主节点告诉结点2它可以传输的帧的最大数量……它有几个缺点，第一个缺点是引入了轮询时延（即通知结点的时间），如果只有一个活跃结点，那么每次发送了他能够发送的最多数量的帧时，主结点必须依次轮询每一个非活跃结点。第二个缺点是，如果主节点故障，整个信道将变得不可操作。

### 令牌环协议

没有轮询协议中所谓的主节点，该协议有一个称为令牌的小的特殊帧在结点之间以某种固定顺序进行交换。一个结点收到令牌，如果它有帧要发送，则发送最大数目的帧数并继续持有该令牌，否则立刻向下一个结点转发该令牌。同样的缺点是，一个结点的故障可能崩溃整个信道，或者结点忘记释放令牌时如何让令牌再次进入循环。

## 5 DOCSIS：用于电缆因特网接入的链路层协议

我们将在DOCSIS中看到信道划分协议， 随机接入协议和轮流协议这三类的每一种协议。

一个电缆接入网将电缆网头端将几千个住宅电缆调制解调器与一个电缆调制解调器端系统（CMTS）连接。DOCSIS使用FDM将下行（CMTS到调制解调器）和上行（调制解调器到CMTS）网络断划分为多个频率信道。每个上行和下行均为广播信道，仅有单一的CMTS在下行信道上传输，不存在多路访问问题。而对于上行则存在。每个上行被划分为时间间隔（类似TDM），每个时间间隔也包括一序列微时隙，调制解调器可以在微时隙中向CMT传输。CMTS在下行信道上通过发送被称为MAP报文的控制报文指定哪个电缆调制解调器能在微时隙中传输控制报文指定的时间间隔。因此能够保证在微时隙中没有碰撞。调制解调器通过向CMTS发送微时隙请求帧来请求传输，这些请求帧可能相互碰撞，如果没有在下一个下行控制报文中收到对请求分配的响应，则推断出请求帧碰撞，使用二进制指数回退将其请求帧延后发送。电缆接入网是FDM,TDM,随机接入和集中分配时隙等协议应用的一个很好的例子。